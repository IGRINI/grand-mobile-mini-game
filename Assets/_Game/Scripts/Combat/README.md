# Система боя

## Обзор
Универсальная система атак с проджектайлами, реализованная по принципам SOLID, DRY, KISS с использованием пулов Zenject.

## Основные компоненты

### 1. Система атак
- `IAttackSystem` - интерфейс системы атак
- `AttackSystem` - реализация системы атак
- Проверяет возможность атаки по дистанции
- Запускает проджектайлы в направлении цели

### 2. Сервис проджектайлов
- `IProjectileService` - интерфейс сервиса проджектайлов
- `ProjectileService` - реализация сервиса
- Использует пул Zenject для создания проджектайлов
- Автоматически наносит урон через HealthService

### 3. Пулы объектов (Zenject)
- `ProjectilePool` - пул проджектайлов
- `ProjectileFactory` - фабрика проджектайлов
- `EnemyPool` - пул врагов
- `EnemyFactory` - фабрика врагов
- Автоматическая инъекция зависимостей через Zenject

### 4. Проджектайлы
- `TimedProjectile` - основной компонент проджектайла с временем жизни
- `Projectile` - старый компонент для совместимости

### 5. Интегрированная логика атак
- `EnemyView` - содержит логику движения и атак врагов
- `CharacterView` - содержит логику атак персонажей
- Убраны отдельные MonoBehaviour контроллеры

## Принципы работы

### Спавн проджектайла
1. Проджектайл берется из пула через ProjectilePool
2. Направление рассчитывается к позиции цели
3. Проджектайл получает скорость из WeaponData.ProjectileSpeed
4. После использования возвращается в пул

### Расчет урона
1. Рассчитывается время полета: distance / speed (используем sqrMagnitude)
2. Через это время автоматически наносится урон цели
3. Проджектайл возвращается в пул

### Спавн врагов
1. EnemyView берется из пула через EnemyPool
2. Автоматически вызывается Inject для зависимостей
3. После смерти врага возвращается в пул

### Архитектурные преимущества
- Нет лишних MonoBehaviour контроллеров
- Автоматическая инъекция зависимостей через Zenject
- Эффективное использование памяти через пулы
- Character и Enemy могут атаковать друг друга
- Система легко расширяется для новых типов целей

## Интеграция
1. Добавить `CombatInstaller` в сцену
2. Настроить префабы для проджектайлов и врагов в инсталлере
3. Пулы создаются автоматически при старте 